<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="{{ url_for('static', filename='images/favicon.ico') }}" type="image/x-icon">

    <title>Task Framework - Turing Tooling</title>
    <script src="https://unpkg.com/vis-network@9.1.2/dist/vis-network.min.js"></script>
    <link href="https://unpkg.com/vis-network@9.1.2/styles/vis-network.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="{{ url_for('static', filename='css/task_framework.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/task_framework_inline.css') }}">
</head>

<body>
    <header class="dashboard-header">
        <div class="logo">
            <a href="/">
                <img id="image-logo" src="{{ url_for('static', filename='images/turing-logo-new.jpg') }}" alt="turing image">
            </a>
        </div>
    </header>

    <div class="main-container">
        <main class="content-area">
            <div class="selector-container">
                <h1 class="selector-title">Task Framework</h1>
                <div class="form-group">
                    <label for="environment" class="form-label">Environment</label>
                    <div class="input-container">
                        <span class="input-icon">üåç</span>
                        <input type="text" id="environment" class="form-input"
                            placeholder="Enter environment name (e.g., hr_payroll)" value="">
                    </div>
                </div>

                <div class="form-group">
                    <label for="interface" class="form-label">Interface</label>
                    <div class="input-container">
                        <span class="input-icon">üîß</span>
                        <select id="interface" class="form-select">
                            <option value="">Select an interface</option>
                            <option value="1">Interface 1</option>
                            <option value="2">Interface 2</option>
                            <option value="3">Interface 3</option>
                            <option value="4">Interface 4</option>
                            <option value="5">Interface 5</option>
                        </select>
                    </div>
                </div>

                <div class="go-button-container">
                    <button class="go-button" onclick="handleGo()">
                        üöÄ GO
                    </button>
                </div>
            </div>

            <div id="actions">
                <div class="add-action-container">
                    <button class="add-action-button" onclick="addAction()">
                        +
                    </button>
                    <span class="add-action-text">Add Action</span>
                </div>

                <div id="api-actions-container">
                    <!-- Dynamic API actions will be added here -->
                </div>

                <div class="import-export-container">
                    <div>
                        <input type="file" id="fileInput" accept=".json" class="hidden-file-input">
                        <button class="import-button" onclick="importActions()">
                            Import Actions
                        </button>
                    </div>

                    <div>
                        <button class="export-button" onclick="exportActions()">
                            Export Actions
                        </button>
                    </div>
                    <div>
                        <button class="run-all-button" onclick="runAllActions()" id="run-all-btn">
                            üöÄ Run All Actions
                        </button>
                    </div>
                </div>
            </div>

            <!-- Difference between actions -->
            <div class="diff-container">
                <div class="diff-header" onclick="toggleDiff()">
                    <div class="diff-title">
                        Task Difference Analyzer
                    </div>
                    <button class="diff-toggle" id="diff-toggle">
                        ‚ñº
                    </button>
                </div>

                <div id="task-diff-content">
                    <h1>Task Diff Analyzer</h1>
                    <div class="input-section">
                        <div class="input-group">
                            <label for="text1">üìÑ Original Task</label>
                            <textarea class="textarea-diff" id="text1" placeholder="Paste your original text here...">The quick brown fox jumps over the lazy dog.
            This is a sample text for comparison.
            You can modify this text to see differences.</textarea>
                        </div>
                        
                        <div class="input-group">
                            <label for="text2">üìù New Task</label>
                            <textarea class="textarea-diff" id="text2" placeholder="Paste your modified text here...">The quick red fox jumps over the sleepy cat.
            This is a sample text for comparison and analysis.
            You can modify this content to see differences highlighted.</textarea>
                        </div>
                    </div>
                    
                    <div class="controls-diff">
                        <button class="button-diff" onclick="compareDiff()">üîç Compare Texts</button>
                        <button class="button-diff" onclick="clearAll()">üóëÔ∏è Clear All</button>
                        <button class="button-diff" onclick="swapTexts()">üîÑ Swap Texts</button>
                    </div>
                    
                    <div class="stats stats-hidden" id="stats">
                        <div class="stat-item">
                            <div class="stat-number" id="addedCount">0</div>
                            <div class="stat-label">Added</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-number" id="removedCount">0</div>
                            <div class="stat-label">Removed</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-number" id="unchangedCount">0</div>
                            <div class="stat-label">Unchanged</div>
                        </div>
                    </div>
                    
                    <div class="diff-section">
                        <div class="diff-panel">
                            <div class="diff-header">üî¥ Old task</div>
                            <div class="diff-content" id="originalDiff">
                                <div class="empty-state">Click "Compare Texts" to see the original text with deletions highlighted</div>
                            </div>
                        </div>
                        
                        <div class="diff-panel">
                            <div class="diff-header">üü¢ New task</div>
                            <div class="diff-content" id="modifiedDiff">
                                <div class="empty-state">Click "Compare Texts" to see the modified text with additions highlighted</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Edge Creation Section -->
            <div class="edge-creation-container">
                <div class="edge-creation-header" onclick="toggleEdgeCreation()">
                    <div class="edge-creation-title">
                        Edge Creation Playground
                    </div>
                    <button class="edge-creation-toggle" id="edge-creation-toggle">
                        ‚ñº
                    </button>
                </div>
                <div class="edge-creation-content" id="edge-creation-content">
                    <textarea id="edge-creation-prompt" rows="4" class="edge-creation-textarea"
                        placeholder="Enter edge creation prompt here..."></textarea>
                </div>
            </div>

            <!-- Graph Editor Section -->
            <div class="graph-editor-container">
                <div class="graph-editor-header" onclick="toggleGraphEditor()">
                    <div class="graph-editor-title">
                        Graph Editor Playground
                    </div>
                    <button class="graph-editor-toggle" id="graph-toggle">
                        ‚ñº
                    </button>
                </div>
                <div class="graph-editor-content" id="graph-editor-content">
                    <div class="graph-controls">
                        <button class="graph-import-button" onclick="importGraphJSON()">
                            üì• Import Graph
                        </button>
                        <button class="graph-export-button" onclick="exportGraphJSON()">
                            üì§ Export Graph
                        </button>
                        <button class="graph-import-button" onclick="populateNodesFromActions()">
                            üìù Populate Nodes from Actions
                        </button>
                    </div>
                    <div id="network"></div>
                    <input type="file" id="graphFileInput" accept=".json" class="graph-file-input-hidden">
                </div>
            </div>

            <div class="save-button-container">
                <button class="save-button" onclick="saveFilteredHTML()">
                    Save Page
                </button>
            </div>
        </main>
    </div>
    
    <script>
        /* function testClick() {
            alert("Test button clicked!");
            apis = document.querySelectorAll('.api-action')
            
            actions = [];
            for (const api of apis) {
                action = {};
                var api_name = api.getElementsByClassName("form-select")[0];
                var api_name = api_name.options[api_name.selectedIndex].text;
                action["name"] = api_name;

                
                const argumentsKeyValue = {};
                const arguments = api.querySelectorAll('input');
                arguments.forEach(argument => {
                    const paramName = argument.dataset.param;
                    argumentsKeyValue[paramName] = argument.value.trim();
                });
                action["arguments"] =argumentsKeyValue;

                actions.push(action);
            }
            console.log("API actions:", actions);
        } */
    </script>

    <script src="{{ url_for('static', filename='scripts/actions_processing.js') }}"></script>
    <script src="{{ url_for('static', filename='scripts/graph_editor.js') }}"></script>
    <script src="{{ url_for('static', filename='scripts/edge_creation.js') }}"></script>
    <script src="{{ url_for('static', filename='scripts/task_difference.js') }}"></script>
</body>

</html>